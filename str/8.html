<!doctype html>
<html lang="ru">

<head>
  <meta charset="utf-8">
  <title>HTML Document Template</title>
  <link href="styles.css" rel="stylesheet">
</head>

<body>
  <div class="header__menu">
    <ul>
      <li><a href="1">1</a></li>
      <li><a href="2">2</a></li>
      <li><a href="3">3</a></li>
      <li><a href="4">4</a></li>
      <li><a href="5">5</a></li>
      <li><a href="6">6</a></li>
      <li><a href="7">7</a></li>
      <li><a href="8">8</a></li>
      <li><a href="9">9</a></li>
      <li><a href="10">10</a></li>
      <li><a href="11">11</a></li>
      <li><a href="12">12</a></li>
      <li><a href="13">13</a></li>
      <li><a href="14">14</a></li>
      <li><a href="15">15</a></li>
      <li><a href="16">16</a></li>
    </ul>
  </div>
  <h1>8</h1>
  <H2 class="OU">
    Оперативный учет
  </H2>
  <pre>
    <p>///// Общий модуль ОбработкаТабличнойЧасти</p>
    Процедура РассчитатьСуммуВСтроке(ТекСтрока) Экспорт
      ТекСтрока.Сумма = ТекСтрока.Цена * ТекСтрока.Количество;
    КонецПроцедуры
    
    <p>///// Общий модуль ПроведениеДокументов</p>
    Процедура СформироватьДвиженияПоИсполнениюБюджета(Объект, Отказ) Экспорт
    
      Движения = Объект.Движения;
      Дата = Объект.Дата;
      Подразделение = Объект.Подразделение;
      СтатьяЗатрат = Объект.СтатьяЗатрат;
      СуммаПоДокументу = Объект.СуммаПоДокументу;
      
      Движение = Движения.Бюджет.Добавить();
      Движение.Период = Дата;
      Движение.Подразделение = Подразделение;
      Движение.СтатьяЗатрат = СтатьяЗатрат;
      Движение.СуммаИсполнения = СуммаПоДокументу;
      
      Движения.Бюджет.Записывать = Истина;
      Движения.Бюджет.БлокироватьДляИзменения = Истина;
      Движения.Записать();
      
      Запрос = Новый Запрос;
      Запрос.Текст = 
        "ВЫБРАТЬ
        |	БюджетОбороты.СуммаОборот КАК Сумма,
        |	БюджетОбороты.СуммаПревышенияОборот КАК СуммаПревышения,
        |	БюджетОбороты.СуммаИсполненияОборот КАК СуммаИсполнения
        |ИЗ
        |	РегистрНакопления.Бюджет.Обороты(
        |			&НачалоПериода,
        |			&КонецПериода,
        |			,
        |			Подразделение = &Подразделение
        |				И СтатьяЗатрат = &СтатьяЗатрат) КАК БюджетОбороты";
      
      Запрос.УстановитьПараметр("НачалоПериода", НачалоМесяца(Дата));
      Запрос.УстановитьПараметр("КонецПериода", КонецМесяца(Дата));	
      Запрос.УстановитьПараметр("Подразделение", Подразделение);
      Запрос.УстановитьПараметр("СтатьяЗатрат", СтатьяЗатрат);
      
      РезультатЗапроса = Запрос.Выполнить();
      
      Выборка = РезультатЗапроса.Выбрать();
      Выборка.Следующий();
      
      Если Выборка.СуммаИсполнения > Выборка.Сумма + Выборка.СуммаПревышения Тогда
        Сообщение = Новый СообщениеПользователю;
        Сообщение.Текст = "Превышение над суммой запланированного бюджета сверх допустимого на " + (Выборка.СуммаИсполнения - (Выборка.Сумма + Выборка.СуммаПревышения));
        Сообщение.Сообщить();	
      ИначеЕсли Выборка.СуммаИсполнения > Выборка.Сумма Тогда
        Сообщение = Новый СообщениеПользователю;
        Сообщение.Текст = "Превышение над суммой запланированного бюджета в пределах допустимого на " + (Выборка.СуммаИсполнения - Выборка.Сумма);
        Сообщение.Сообщить();
      КонецЕсли;
      
    КонецПроцедуры
    
    <p>///// Документ ПриходнаяНакладная</p>
    Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
      СуммаПоДокументу = СписокНоменклатуры.Итог("Сумма");
    КонецПроцедуры
    
    Процедура ОбработкаПроведения(Отказ, РежимПроведения)
      ПроведениеДокументов.СформироватьДвиженияПоИсполнениюБюджета(ЭтотОбъект, Отказ);
    КонецПроцедуры
    
    <p>///// Документ РасходнаяНакладная</p> 
    Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
      СуммаПоДокументу = СписокНоменклатуры.Итог("Сумма");
    КонецПроцедуры
    
    Процедура ОбработкаПроведения(Отказ, РежимПроведения)		
      ПроведениеДокументов.СформироватьДвиженияПоИсполнениюБюджета(ЭтотОбъект, Отказ);
    КонецПроцедуры
    
    <p>///// Документ ПриходДенег</p>
    Процедура ОбработкаПроведения(Отказ, РежимПроведения)
      ПроведениеДокументов.СформироватьДвиженияПоИсполнениюБюджета(ЭтотОбъект, Отказ);
    КонецПроцедуры
    
    <p>///// Документ РасходДенег</p>
    Процедура ОбработкаПроведения(Отказ, РежимПроведения)
      ПроведениеДокументов.СформироватьДвиженияПоИсполнениюБюджета(ЭтотОбъект, Отказ);
    КонецПроцедуры
    
    <p>///// Документ Бюджет</p> 
    Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
      Период = НачалоМесяца(Период);
    КонецПроцедуры
    
    Процедура ОбработкаПроведения(Отказ, РежимПроведения)
      
      Движения.Бюджет.Записывать = Истина;
      
      Для Каждого Строка Из СтатьиЗатрат Цикл
        Движение = Движения.Бюджет.Добавить();
        Движение.Период = Период;
        Движение.Подразделение = Подразделение;
        Движение.СтатьяЗатрат = Строка.СтатьяЗатрат;
        Движение.Сумма = Строка.Сумма;
        Движение.СуммаПревышения = Строка.СуммаПревышения;
      КонецЦикла;
      
    КонецПроцедуры
    
    <p>///// Модуль формы</p>
    &НаКлиенте
    Процедура СписокНоменклатурыКоличествоПриИзменении(Элемент)
      ТекСтрока = Элементы.СписокНоменклатуры.ТекущиеДанные;
      ОбработкаТабличнойЧасти.РассчитатьСуммуВСтроке(ТекСтрока);
    КонецПроцедуры
    
    &НаКлиенте
    Процедура СписокНоменклатурыЦенаПриИзменении(Элемент)
      ТекСтрока = Элементы.СписокНоменклатуры.ТекущиеДанные;
      ОбработкаТабличнойЧасти.РассчитатьСуммуВСтроке(ТекСтрока);
    КонецПроцедуры
    <embed src="pdf/ОбщееОУ8.pdf" type="application/pdf" width="1200" height="800">
      <img src="pdf/ОУ8.jpg">
    <H2 class="OU">
      Бухгалтерский учет
    </H2>
    <p>///// Общий модуль ОбработкаТабличнойЧастиКлиент</p>
    Процедура РассчитатьСуммуВСтроке(ТекСтрока) Экспорт
      ТекСтрока.Сумма = ТекСтрока.Цена * ТекСтрока.Количество;
    КонецПроцедуры 
    
    <p>///// Документ Операция</p>  
    Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
      Если Не Движения.Управленческий.Записывать Тогда
        Движения.Управленческий.Прочитать();
        Движения.Управленческий.Записывать = Истина;
      КонецЕсли;
      
      Для Каждого Движение Из Движения.Управленческий Цикл
        Движение.Период = Дата;
        Движение.Активность = Не ПометкаУдаления;
      КонецЦикла;
    КонецПроцедуры
    
    Процедура ПриКопировании(ОбъектКопирования)	
      Выборка = РегистрыБухгалтерии.Управленческий.ВыбратьПоРегистратору(ОбъектКопирования.Ссылка);
      Пока Выборка.Следующий() Цикл
        Движение = Движения.Управленческий.Добавить();
        ЗаполнитьЗначенияСвойств(Движение, Выборка);
        ЗаполнитьЗначенияСвойств(Движение.СубконтоДт, Выборка.СубконтоДт);
        ЗаполнитьЗначенияСвойств(Движение.СубконтоКт, Выборка.СубконтоКт);
      КонецЦикла;
    КонецПроцедуры
     
    <p>///// Документ ПриходнаяНакладная</p>
    Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
      СуммаПоДокументу = СписокНоменклатуры.Итог("Сумма");
    КонецПроцедуры
    
    Процедура ОбработкаПроведения(Отказ, РежимПроведения)
      
      // регистр Управленческий 
      Движения.Управленческий.Записывать = Истина;
      Для Каждого ТекСтрокаСписокНоменклатуры Из СписокНоменклатуры Цикл
        Движение = Движения.Управленческий.Добавить();
        Движение.СчетДт = ПланыСчетов.Управленческий.Товары;
        Движение.СчетКт = ПланыСчетов.Управленческий.Поставщики;
        Движение.Период = Дата;
        Движение.Сумма = ТекСтрокаСписокНоменклатуры.Сумма;
        Движение.СубконтоДт[ПланыВидовХарактеристик.ВидыСубконто.Номенклатура] = ТекСтрокаСписокНоменклатуры.Номенклатура;
        Движение.СубконтоДт[ПланыВидовХарактеристик.ВидыСубконто.ИнвентарныеНомера] = ТекСтрокаСписокНоменклатуры.ИнвентарныйНомер;
        Движение.КоличествоДт = ТекСтрокаСписокНоменклатуры.Количество;
      КонецЦикла;
      
    КонецПроцедуры
    
    <p>///// Документ РасходнаяНакладная</p> 
    Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
      СуммаПоДокументу = СписокНоменклатуры.Итог("Сумма");
    КонецПроцедуры
    
    Процедура ОбработкаПроведения(Отказ, РежимПроведения)
      
      Движения.Управленческий.Записывать = Истина;
      Движения.Записать();
      
      Движения.Управленческий.Записывать = Истина;
      
      Блокировка = Новый БлокировкаДанных;
      ЭлементБлокировки = Блокировка.Добавить("РегистрБухгалтерии.Управленческий");
      ЭлементБлокировки.Режим = РежимБлокировкиДанных.Исключительный;
      ЭлементБлокировки.УстановитьЗначение("Счет", ПланыСчетов.Управленческий.Товары);
      ЭлементБлокировки.ИсточникДанных = СписокНоменклатуры;
      ЭлементБлокировки.ИспользоватьИзИсточникаДанных(ПланыВидовХарактеристик.ВидыСубконто.Номенклатура, "Номенклатура");
      ЭлементБлокировки.ИспользоватьИзИсточникаДанных(ПланыВидовХарактеристик.ВидыСубконто.ИнвентарныеНомера, "ИнвентарныйНомер");
      Блокировка.Заблокировать();
      
      Запрос = Новый Запрос;
      Запрос.Текст = 
        "ВЫБРАТЬ
        |	РасходнаяНакладнаяСписокНоменклатуры.Номенклатура КАК Номенклатура,
        |	РасходнаяНакладнаяСписокНоменклатуры.ИнвентарныйНомер КАК ИнвентарныйНомер,
        |	СУММА(РасходнаяНакладнаяСписокНоменклатуры.Сумма) КАК Сумма,
        |	СУММА(РасходнаяНакладнаяСписокНоменклатуры.Количество) КАК Количество
        |ПОМЕСТИТЬ втТЧТовары
        |ИЗ
        |	Документ.РасходнаяНакладная.СписокНоменклатуры КАК РасходнаяНакладнаяСписокНоменклатуры
        |ГДЕ
        |	РасходнаяНакладнаяСписокНоменклатуры.Ссылка = &Ссылка
        |
        |СГРУППИРОВАТЬ ПО
        |	РасходнаяНакладнаяСписокНоменклатуры.Номенклатура,
        |	РасходнаяНакладнаяСписокНоменклатуры.ИнвентарныйНомер
        |
        |ИНДЕКСИРОВАТЬ ПО
        |	Номенклатура,
        |	ИнвентарныйНомер
        |;
        |
        |////////////////////////////////////////////////////////////////////////////////
        |ВЫБРАТЬ
        |	втТЧТовары.Номенклатура КАК Номенклатура,
        |	втТЧТовары.Номенклатура.Представление КАК НоменклатураПредставление,
        |	втТЧТовары.ИнвентарныйНомер КАК ИнвентарныйНомер,
        |	втТЧТовары.ИнвентарныйНомер.Представление КАК ИнвентарныйНомерПредставление,
        |	втТЧТовары.Количество КАК Количество,
        |	втТЧТовары.Сумма КАК Сумма,
        |	ЕСТЬNULL(УправленческийОстатки.СуммаОстаток, 0) КАК СуммаОстаток,
        |	ЕСТЬNULL(УправленческийОстатки.КоличествоОстаток, 0) КАК КоличествоОстаток
        |ИЗ
        |	втТЧТовары КАК втТЧТовары
        |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Управленческий.Остатки(
        |				&МоментВремени,
        |				Счет = &СчетТовары,
        |				&ВидыСубконто,
        |				(Субконто1, Субконто2) В
        |					(ВЫБРАТЬ
        |						втТЧТовары.Номенклатура КАК Номенклатура,
        |						втТЧТовары.ИнвентарныйНомер КАК ИнвентарныйНомер
        |					ИЗ
        |						втТЧТовары КАК втТЧТовары)) КАК УправленческийОстатки
        |		ПО втТЧТовары.Номенклатура = УправленческийОстатки.Субконто1
        |			И втТЧТовары.ИнвентарныйНомер = УправленческийОстатки.Субконто2";
      
      ВидыСубконто = Новый Массив;
      ВидыСубконто.Добавить(ПланыВидовХарактеристик.ВидыСубконто.Номенклатура);
      ВидыСубконто.Добавить(ПланыВидовХарактеристик.ВидыСубконто.ИнвентарныеНомера);
      
      Запрос.УстановитьПараметр("ВидыСубконто", ВидыСубконто);
      Запрос.УстановитьПараметр("МоментВремени", МоментВремени());
      Запрос.УстановитьПараметр("Ссылка", Ссылка);
      Запрос.УстановитьПараметр("СчетТовары", ПланыСчетов.Управленческий.Товары);
      
      РезультатЗапроса = Запрос.Выполнить();
      
      Выборка = РезультатЗапроса.Выбрать();
      
      Пока Выборка.Следующий() Цикл
        
        Если Выборка.Количество > Выборка.КоличествоОстаток Тогда
          Отказ = Истина;
          Сообщение = Новый СообщениеПользователю;
          Сообщение.Текст = СтрШаблон("Недостаточно товара %1 с инв.номером %2 в количестве %3",
          Выборка.НоменклатураПредставление, Выборка.ИнвентарныйНомерПредставление, Выборка.Количество - Выборка.КоличествоОстаток);
          Сообщение.Сообщить();
        КонецЕсли;
        
        Если Отказ Тогда
          Продолжить;
        КонецЕсли;
        
        // себестоимость
        Если Выборка.Количество = Выборка.КоличествоОстаток Тогда
          Себестоимость = Выборка.СуммаОстаток;
        Иначе
          Себестоимость = Выборка.СуммаОстаток / Выборка.КоличествоОстаток * Выборка.Количество;
        КонецЕсли;
        
        Движение = Движения.Управленческий.Добавить();
        Движение.Период = Дата;
        Движение.СчетДт = ПланыСчетов.Управленческий.ПрибылиУбытки;
        Движение.СубконтоДт[ПланыВидовХарактеристик.ВидыСубконто.Номенклатура] = Выборка.Номенклатура;
        Движение.СубконтоДт[ПланыВидовХарактеристик.ВидыСубконто.ИнвентарныеНомера] = Выборка.ИнвентарныйНомер;
        Движение.СубконтоДт[ПланыВидовХарактеристик.ВидыСубконто.ФизическиеЛица] = Сотрудник;
        
        Движение.СчетКт = ПланыСчетов.Управленческий.Товары;
        Движение.СубконтоКт[ПланыВидовХарактеристик.ВидыСубконто.Номенклатура] = Выборка.Номенклатура;
        Движение.СубконтоКт[ПланыВидовХарактеристик.ВидыСубконто.ИнвентарныеНомера] = Выборка.ИнвентарныйНомер;		
        Движение.КоличествоКт = Выборка.Количество;
        
        Движение.Сумма = Себестоимость;
        
        // продажа
        Движение = Движения.Управленческий.Добавить();
        Движение.Период = Дата;
        Движение.СчетДт = ПланыСчетов.Управленческий.Покупатели;
        Движение.СчетКт = ПланыСчетов.Управленческий.ПрибылиУбытки;
        Движение.СубконтоКт[ПланыВидовХарактеристик.ВидыСубконто.Номенклатура] = Выборка.Номенклатура;
        Движение.СубконтоКт[ПланыВидовХарактеристик.ВидыСубконто.ИнвентарныеНомера] = Выборка.ИнвентарныйНомер;
        Движение.СубконтоКт[ПланыВидовХарактеристик.ВидыСубконто.ФизическиеЛица] = Сотрудник;
        Движение.Сумма = Выборка.Сумма;
      КонецЦикла;
    
      
    КонецПроцедуры
    
    <p>///// Модуль формы</p>
    &НаКлиенте
    Процедура СписокНоменклатурыКоличествоПриИзменении(Элемент)
      ТекСтрока = Элементы.СписокНоменклатуры.ТекущиеДанные;
      ОбработкаТабличнойЧасти.РассчитатьСуммуВСтроке(ТекСтрока);
    КонецПроцедуры
    
    &НаКлиенте
    Процедура СписокНоменклатурыЦенаПриИзменении(Элемент)
      ТекСтрока = Элементы.СписокНоменклатуры.ТекущиеДанные;
      ОбработкаТабличнойЧасти.РассчитатьСуммуВСтроке(ТекСтрока);
    КонецПроцедуры
    
    &НаКлиенте
    Процедура СписокНоменклатурыПриНачалеРедактирования(Элемент, НоваяСтрока, Копирование)
      Если НоваяСтрока Тогда
        ТекущиеДанные = Элементы.СписокНоменклатуры.ТекущиеДанные;
        ТекущиеДанные.Количество = 1;
      КонецЕсли;
    КонецПроцедуры
    <embed src="pdf/ОбщееБУ8.pdf" type="application/pdf" width="1200" height="800">
      <img src="pdf/БУ8.jpg">
    <H2 class="OU">
      Расчеты
    </H2>
    <p>///// Документ НачислениеЗарплаты</p>   
    Процедура ОбработкаПроведения(Отказ, РежимПроведения)
      
      ПериодРегистрации = НачалоМесяца(Дата);
      КонецПериодаРегистрации = КонецМесяца(Дата);
      
      Запрос = Новый Запрос;
      Запрос.Текст = 
        "ВЫБРАТЬ
        |	НачислениеЗарплатыОсновныеНачисления.Сотрудник КАК Сотрудник,
        |	НачислениеЗарплатыОсновныеНачисления.Подразделение КАК Подразделение,
        |	НачислениеЗарплатыОсновныеНачисления.Подразделение.ГрафикРаботы КАК ГрафикРаботы,
        |	НачислениеЗарплатыОсновныеНачисления.ДатаНачала КАК ПериодДействияНачало,
        |	КОНЕЦПЕРИОДА(НачислениеЗарплатыОсновныеНачисления.ДатаОкончания, ДЕНЬ) КАК ПериодДействияКонец,
        |	НачислениеЗарплатыОсновныеНачисления.ВидРасчета КАК ВидРасчета
        |ИЗ
        |	Документ.НачислениеЗарплаты.ОсновныеНачисления КАК НачислениеЗарплатыОсновныеНачисления
        |ГДЕ
        |	НачислениеЗарплатыОсновныеНачисления.Ссылка = &Ссылка";
      
      Запрос.УстановитьПараметр("Ссылка", Ссылка);
      
      РезультатЗапроса = Запрос.Выполнить();
      
      Выборка = РезультатЗапроса.Выбрать();
      
      Пока Выборка.Следующий() Цикл
        Движение = Движения.ОсновныеНачисления.Добавить();
        ЗаполнитьЗначенияСвойств(Движение, Выборка);
        Движение.ПериодРегистрации = ПериодРегистрации;
      КонецЦикла;
      Движения.ОсновныеНачисления.Записать();
        
      Запрос = Новый Запрос;
      Запрос.Текст = 
        "ВЫБРАТЬ
        |	ОсновныеНачисленияДанныеГрафика.НомерСтроки КАК НомерСтроки,
        |	ЕСТЬNULL(ОсновныеНачисленияДанныеГрафика.ЧасовФактическийПериодДействия, 0) КАК ОтработаноЧасов,
        |	ЕСТЬNULL(ШкалаТарифныхСтавок.ТарифнаяСтавка, 0) КАК ТарифнаяСтавка,
        |	ЕСТЬNULL(ОсновныеНачисленияДанныеГрафика.ДнейФактическийПериодДействия, 0) КАК ОтработаноДней
        |ИЗ
        |	РегистрРасчета.ОсновныеНачисления.ДанныеГрафика(
        |			Регистратор = &Ссылка
        |				И ВидРасчета В (&ВидыРасчета)) КАК ОсновныеНачисленияДанныеГрафика
        |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ШкалаТарифныхСтавок КАК ШкалаТарифныхСтавок
        |		ПО ОсновныеНачисленияДанныеГрафика.Подразделение = ШкалаТарифныхСтавок.Подразделение
        |			И ОсновныеНачисленияДанныеГрафика.ЧасовФактическийПериодДействия > ШкалаТарифныхСтавок.ЧасовОт
        |			И ОсновныеНачисленияДанныеГрафика.ЧасовФактическийПериодДействия <= ШкалаТарифныхСтавок.ЧасовДо";
    
      ВидыРасчета = Новый Массив();
      ВидыРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисления.ОплатаПоЧасовомуТарифу);
      Запрос.УстановитьПараметр("ВидыРасчета", ВидыРасчета);
      
      Запрос.УстановитьПараметр("Ссылка", Ссылка);
      
      РезультатЗапроса = Запрос.Выполнить();
      
      Выборка = РезультатЗапроса.Выбрать();
      
      Для Каждого Движение Из Движения.ОсновныеНачисления Цикл
        
        Если ВидыРасчета.Найти(Движение.ВидРасчета) = Неопределено Тогда
          Продолжить;			
        КонецЕсли;      
        
        Выборка.Сбросить();
        Выборка.НайтиСледующий(Движение.НомерСтроки, "НомерСтроки");
        
        Если Движение.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисления.ОплатаПоЧасовомуТарифу Тогда
          Движение.Результат = Выборка.ОтработаноЧасов * Выборка.ТарифнаяСтавка;
          ЗаполнитьЗначенияСвойств(Движение, Выборка, "ОтработаноЧасов, ТарифнаяСтавка, ОтработаноДней");
        КонецЕсли;
        
      КонецЦикла;
      
      Движения.ОсновныеНачисления.Записать(, Истина);
      
      Запрос = Новый Запрос;
      Запрос.Текст = 
        "ВЫБРАТЬ
        |	ДополнительныеНачисленияБазаОсновныеНачисления.НомерСтроки КАК НомерСтроки,
        |	ДополнительныеНачисленияБазаОсновныеНачисления.ОтработаноДнейБаза КАК ОтработаноДней
        |ИЗ
        |	РегистрРасчета.ДополнительныеНачисления.БазаОсновныеНачисления(
        |			&Измерения,
        |			&Измерения,
        |			,
        |			Регистратор = &Ссылка
        |				И ВидРасчета В (&ВидыРасчета)) КАК ДополнительныеНачисленияБазаОсновныеНачисления";
      
      ВидыРасчета = Новый Массив;
      ВидыРасчета.Добавить(ПланыВидовРасчета.ДополнительныеНачисления.КомпенсацияЗаМобильный);
      Запрос.УстановитьПараметр("ВидыРасчета", ВидыРасчета);
      
      Измерения = Новый Массив;
      Измерения.Добавить("Сотрудник");
      Запрос.УстановитьПараметр("Измерения", Измерения);
      Запрос.УстановитьПараметр("Ссылка", Ссылка);
      
      РезультатЗапроса = Запрос.Выполнить();
      
      Выборка = РезультатЗапроса.Выбрать();
      
      Для Каждого Движение Из Движения.ДополнительныеНачисления Цикл
        
        Если ВидыРасчета.Найти(Движение.ВидРасчета) = Неопределено Тогда
          Продолжить;			
        КонецЕсли;     
        
        Выборка.Сбросить();
        Если Выборка.НайтиСледующий(Движение.НомерСтроки, "НомерСтроки") Тогда
          
          Если Движение.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисления.КомпенсацияЗаМобильный Тогда
            Движение.Результат = Выборка.ОтработаноДней * Движение.Параметр;
            ЗаполнитьЗначенияСвойств(Движение, Выборка, "ОтработаноДней");
          КонецЕсли;
          
        КонецЕсли;
        
      КонецЦикла;
      
      Движения.ДополнительныеНачисления.Записать();
    КонецПроцедуры
    
    <p>///// Модуль объекта ЗаполнениеГрафика</p>
    Процедура ЗаполнитьГрафик(ДатаНачала, ДатаОкончания, ВыходныеДни, ГрафикРаботы) Экспорт 
      
      Набор = РегистрыСведений.ГрафикиРаботы.СоздатьНаборЗаписей();
      
      Набор.Отбор.ГрафикРаботы.Установить(ГрафикРаботы);
        
      ЧислоСекундВСутках = 86400;
      
      Дат = ДатаНачала;	
      Пока Дат <= ДатаОкончания Цикл
        Запись = Набор.Добавить();
        Запись.ГрафикРаботы = ГрафикРаботы;
        Запись.Дата = Дат;
        Если Найти(ВыходныеДни, Строка(ДеньНедели(Дат))) Тогда
          Запись.Дней = 0;
          Запись.Часов = 0;
        Иначе	          
          Запись.Дней  = 1;
          Запись.Часов = 8;
        КонецЕсли; 
        Дат = Дат + ЧислоСекундВСутках;
      КонецЦикла; 
      Набор.Записать();
    КонецПроцедуры
    
    <p>///// Модуль формы</p>
    &НаКлиенте
    Процедура Заполнить(Команда)
      ВыполнитьОбработку();
      Сообщить("Обработка завершена!");
    КонецПроцедуры
    
    &НаСервере
    Процедура ВыполнитьОбработку()
      ОбработкаОбъект = РеквизитФормыВЗначение("Объект");
        ОбработкаОбъект.ЗаполнитьГрафик(ВыборПериода.ДатаНачала, ВыборПериода.ДатаОкончания, ВыходныеДни, ГрафикРаботы);
    КонецПроцедуры
    <embed src="pdf/ОбщееСПР8.pdf" type="application/pdf" width="1200" height="800">
      <img src="pdf/СПР8.jpg">
  </pre>
</body>

</html>
